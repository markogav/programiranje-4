#include <bits/stdc++.h>
using namespace std;
using ull = unsigned long long;
string s;
vector<ull> H, P;
ull getHash(int l, int r) {
    return H[r + 1] - H[l] * P[r - l + 1];//standardna hash formula
}
int main() {
    cin >> s;
    int n = s.size();
    string good;
    cin >> good;
    int k;
    cin >> k;
    int bad[26];
    for (int i = 0; i < 26; i++)
        bad[i] = (good[i] == '0');//pretvaranje 0 i 1 vo integers
    const ull BASE = 1315423911ULL;
    H.assign(n + 1, 0);
    P.assign(n + 1, 0);//gi mestime H i P na 0
    P[0] = 1;
    for (int i = 0; i < n; i++) {
        H[i + 1] = H[i] * BASE + (s[i] - 'a' + 1);
        P[i + 1] = P[i] * BASE;
    }
    unordered_set<ull> seen;//hash set za cuvanje substringovi
    for (int i = 0; i < n; i++) {
        int cntBad = 0;
        for (int j = i; j < n; j++) {
            if (bad[s[j] - 'a']) {
                if (++cntBad > k) break;
            }
            seen.insert(getHash(i, j));
        }
    }
    cout << seen.size() << "\n";
    return 0;
}
